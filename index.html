<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TFPCOIN</title>

  <!-- ✅ Favicon (put favicon.png in SAME folder as index.html) -->
  <link rel="icon" type="image/png" href="favicon.png" />

  <style>
    :root{
      --bg:#070a10;
      --card: rgba(255,255,255,0.06);
      --stroke: rgba(255,255,255,0.14);
      --muted: rgba(255,255,255,0.72);
      --text:#ffffff;
      --grad: linear-gradient(135deg, #00f5ff, #7f00ff);
      --shadow: 0 18px 70px rgba(0,0,0,0.55);
      --radius: 18px;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      background: radial-gradient(circle at top, #0f2027, #000000);
      color: var(--text);
    }

    a{ color: inherit; }

    .wrap{
      max-width: 1120px;
      margin: 0 auto;
      padding: 28px 16px 60px;
    }

    header{ padding: 28px 0 8px; }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 260px;
    }

    .brand img{
      width: 52px;
      height: 52px;
      border-radius: 14px;
      object-fit: cover;
      background: rgba(255,255,255,0.08);
      border:1px solid var(--stroke);
    }

    .brand h1{
      margin:0;
      font-size: 22px;
      letter-spacing: 1px;
    }

    .btnrow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 11px 14px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,0.06);
      color: #fff;
      text-decoration:none;
      font-weight: 800;
      cursor:pointer;
      user-select:none;
      letter-spacing: .4px;
    }
    .btn:hover{ opacity: 0.95; }

    .btn.primary{
      background: var(--grad);
      border: none;
      color: #06060a;
    }

    .hero{
      margin-top: 18px;
      padding: 22px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,0.05);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .hero h2{
      margin: 0 0 8px;
      font-size: 28px;
    }

    .hero p{
      margin: 0;
      color: var(--muted);
      line-height: 1.5;
      max-width: 820px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 16px;
      margin-top: 16px;
    }

    @media (max-width: 900px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border: 1px solid var(--stroke);
      background: var(--card);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: 0 8px 40px rgba(0,0,0,0.25);
    }

    .card h3{
      margin: 0 0 10px;
      font-size: 18px;
    }

    .muted{ color: var(--muted); }

    code{
      display:block;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.35);
      word-break: break-all;
    }

    .pillrow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 12px;
    }

    .pill{
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.06);
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 12px;
      color: rgba(255,255,255,0.85);
      font-weight: 800;
    }

    .pill.good{ background: rgba(0,255,180,0.10); }
    .pill.warn{ background: rgba(255,170,0,0.10); }

    .two{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 620px){
      .two{ grid-template-columns: 1fr; }
    }

    .line{
      height: 1px;
      background: rgba(255,255,255,0.10);
      margin: 14px 0;
    }

    .list{
      margin: 10px 0 0 18px;
      color: rgba(255,255,255,0.85);
    }
    .list li{ margin-bottom: 8px; }

    footer{
      margin-top: 22px;
      text-align:center;
      color: rgba(255,255,255,0.55);
      font-size: 12px;
    }

    /* Modal */
    .overlay{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.72);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 9999;
    }
    .overlay.open{ display:flex; }

    .modal{
      width: min(980px, 96vw);
      max-height: 92vh;
      overflow: hidden;
      background: #0b0f14;
      border: 1px solid rgba(255,255,255,0.14);
      border-radius: 18px;
      box-shadow: var(--shadow);
    }

    .modalhead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255,255,255,0.10);
    }

    .modalhead h3{
      margin:0;
      font-size: 16px;
    }

    .modalclose{
      background: transparent;
      border: none;
      color: #fff;
      font-size: 20px;
      cursor: pointer;
      padding: 6px 10px;
    }

    .modalbody{ padding: 14px 16px 16px; }

    .small{
      font-size: 12px;
      color: rgba(255,255,255,0.65);
      line-height: 1.45;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="topbar">
        <div class="brand">
          <!-- ✅ Logo (put logo.png in SAME folder as index.html) -->
          <img src="logo.png" alt="TFPCOIN Logo" />
          <div>
            <h1>TFPCOIN</h1>
            <!-- ✅ removed “Polygon Token / Official Website” line -->
          </div>
        </div>

        <div class="btnrow">
          <button class="btn primary" id="btnBuy">Buy TFPCOIN</button>
          <button class="btn" id="btnMerch">KARI'S CLOSET</button>
          <a class="btn" href="assets/TFPCOIN_Whitepaper.pdf" target="_blank" rel="noopener">Whitepaper</a>
          <button class="btn" id="btnConnect">Connect Wallet</button>
        </div>
      </div>

      <div class="hero">
        <h2>The Future of Digital Value</h2>
        <p>
          TFPCOIN is built for community, utility, and real-world digital commerce.
          Buy TFPCOIN, verify the contract, and shop official merch directly from this site.
        </p>

        <div class="pillrow" style="margin-top:14px;">
          <span class="pill" id="pillWallet">Wallet: Not connected</span>
          <span class="pill" id="pillNetwork">Network: Not checked</span>
        </div>
      </div>
    </header>

    <div class="grid">
      <div class="card">
        <h3>Contract & Links</h3>
        <div class="muted">TFPCOIN Contract (Polygon)</div>
        <code id="tokenAddr">0xcEc2f2b98B98f5ac69E819C7EC3627162cF8C21B</code>

        <div class="btnrow" style="justify-content:flex-start; margin-top:12px;">
          <button class="btn" id="btnCopy">Copy Contract</button>
          <button class="btn" id="btnAddMM">Add TFPCOIN to MetaMask</button>
          <a class="btn" id="btnScan" target="_blank" rel="noopener">View on PolygonScan</a>
        </div>

        <div class="line"></div>

        <div class="two">
          <div class="card" style="box-shadow:none;">
            <h3 style="margin-bottom:6px;">Live Price</h3>
            <div class="muted">TFPCOIN (USD)</div>
            <div style="font-size:26px;font-weight:900;margin-top:6px;" id="priceUsd">—</div>
            <div class="small" id="priceNote">Pulling from DexScreener…</div>
          </div>

          <div class="card" style="box-shadow:none;">
            <h3 style="margin-bottom:6px;">Market Cap</h3>
            <div class="muted">Estimated (USD)</div>
            <div style="font-size:26px;font-weight:900;margin-top:6px;" id="mcUsd">—</div>
            <div class="small">Shows when DexScreener indexes the pair.</div>
          </div>
        </div>

        <div class="line"></div>

        <h3 style="margin-bottom:6px;">Merch Conversion</h3>
        <div class="muted">Jersey price: <b>$70</b></div>
        <div style="margin-top:8px;font-size:18px;font-weight:900;">
          ≈ <span id="tfpFor70">—</span> TFPCOIN
        </div>
        <div class="small">
          Auto-updates from live TFPCOIN price (DexScreener). If price is unavailable, it stays as “—”.
        </div>
      </div>

      <div class="card">
        <h3>How to Buy TFPCOIN</h3>
        <ol class="list">
          <li>Click <b>Buy TFPCOIN</b> (opens a new tab).</li>
          <li>In Uniswap, make sure you’re on <b>Polygon</b>.</li>
          <li>Swap <b>USDC → TFPCOIN</b>.</li>
          <li>Click <b>Add TFPCOIN to MetaMask</b> to display your balance.</li>
        </ol>

        <div class="line"></div>

        <h3>Trust Indicators</h3>
        <div class="pillrow">
          <span class="pill good">Contract: Verified</span>
          <span class="pill good">Liquidity Lock: Verified</span>
          <span class="pill warn">Audit: Coming Soon</span>
        </div>

        <div class="line"></div>

        <h3>Quick Actions</h3>
        <div class="btnrow" style="justify-content:flex-start;">
          <button class="btn" id="btnSwitch">Switch to Polygon</button>
          <a class="btn" id="btnChart" target="_blank" rel="noopener">View Chart</a>
        </div>

        <p class="small" style="margin-top:12px;">
          If Uniswap still asks you to “Select token”, search the contract address and import TFPCOIN once.
        </p>
      </div>
    </div>

    <footer>© 2026 TFPCOIN. All Rights Reserved.</footer>
  </div>

  <!-- MERCH MODAL (Shopify Buy Button) -->
  <div class="overlay" id="merchOverlay" aria-hidden="true" style="z-index:10000;">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="merchTitle">
      <div class="modalhead">
        <h3 id="merchTitle">KARI'S CLOSET</h3>
        <button class="modalclose" id="merchClose" aria-label="Close">✕</button>
      </div>
      <div class="modalbody">
        <div class="small" style="margin-bottom:10px;">Secure checkout powered by Shopify.</div>
        <div style="display:flex;justify-content:center;flex-wrap:wrap;">
          <div id="product-component-1769653146260"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // ====== CONFIG ======
      const TFPCOIN = {
        address: "0xcEc2f2b98B98f5ac69E819C7EC3627162cF8C21B",
        symbol: "TFP",
        decimals: 18
      };

      const POLYGON = {
        chainIdHex: "0x89",
        chainName: "Polygon Mainnet",
        nativeCurrency: { name: "POL", symbol: "POL", decimals: 18 },
        rpcUrls: ["https://polygon-rpc.com/"],
        blockExplorerUrls: ["https://polygonscan.com/"]
      };

      const USDC_POLYGON = "0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174";

      // Links
      const btnScan = document.getElementById("btnScan");
      const btnChart = document.getElementById("btnChart");
      if (btnScan) btnScan.href = "https://polygonscan.com/token/" + TFPCOIN.address;
      if (btnChart) btnChart.href = "https://dexscreener.com/polygon/" + TFPCOIN.address;

      // ====== BUY (NEW TAB) ======
      const UNISWAP_URL =
        "https://app.uniswap.org/#/swap" +
        "?chain=polygon" +
        "&inputCurrency=" + encodeURIComponent(USDC_POLYGON) +
        "&outputCurrency=" + encodeURIComponent(TFPCOIN.address) +
        "&theme=dark";

      function openSwapNewTab(){
        window.open(UNISWAP_URL, "_blank", "noopener");
      }

      document.getElementById("btnBuy")?.addEventListener("click", openSwapNewTab);

      // ====== MERCH MODAL ======
      const merchOverlay = document.getElementById("merchOverlay");
      const merchClose = document.getElementById("merchClose");

      function openMerch(){
        merchOverlay.classList.add("open");
        merchOverlay.setAttribute("aria-hidden","false");
        document.body.style.overflow = "hidden";
        renderShopifyOnce();
      }
      function closeMerch(){
        merchOverlay.classList.remove("open");
        merchOverlay.setAttribute("aria-hidden","true");
        document.body.style.overflow = "";
      }

      document.getElementById("btnMerch")?.addEventListener("click", openMerch);
      merchClose?.addEventListener("click", closeMerch);
      merchOverlay?.addEventListener("click", (e)=>{ if(e.target===merchOverlay) closeMerch(); });

      document.addEventListener("keydown", (e)=>{
        if(e.key==="Escape" && merchOverlay?.classList.contains("open")) closeMerch();
      });

      // ====== WALLET CONNECT + NETWORK ======
      async function getChainId(){
        if(!window.ethereum) return null;
        return await window.ethereum.request({ method: "eth_chainId" });
      }

      async function checkNetworkPill(){
        const pill = document.getElementById("pillNetwork");
        if(!pill) return;

        if(!window.ethereum){
          pill.textContent = "Network: No wallet";
          pill.className = "pill warn";
          return;
        }
        const chainId = await getChainId();
        if(chainId === POLYGON.chainIdHex){
          pill.textContent = "Network: Polygon ✅";
          pill.className = "pill good";
        } else {
          pill.textContent = "Network: Wrong network";
          pill.className = "pill warn";
        }
      }

      async function switchToPolygon(){
        if(!window.ethereum) return alert("MetaMask not detected. Please install MetaMask.");
        try{
          await window.ethereum.request({
            method: "wallet_switchEthereumChain",
            params: [{ chainId: POLYGON.chainIdHex }]
          });
        } catch (err){
          if(err && err.code === 4902){
            await window.ethereum.request({
              method: "wallet_addEthereumChain",
              params: [{
                chainId: POLYGON.chainIdHex,
                chainName: POLYGON.chainName,
                nativeCurrency: POLYGON.nativeCurrency,
                rpcUrls: POLYGON.rpcUrls,
                blockExplorerUrls: POLYGON.blockExplorerUrls
              }]
            });
          }
        }
        await checkNetworkPill();
      }

      async function connectWallet(){
        if(!window.ethereum) return alert("MetaMask not detected. Please install MetaMask.");
        try{
          const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
          const addr = accounts?.[0];
          const pill = document.getElementById("pillWallet");
          if(addr && pill){
            pill.textContent = "Wallet: " + addr.slice(0,6) + "..." + addr.slice(-4);
            pill.className = "pill good";
          }
          await checkNetworkPill();
        } catch(e){
          alert("Connection request rejected.");
        }
      }

      document.getElementById("btnConnect")?.addEventListener("click", connectWallet);
      document.getElementById("btnSwitch")?.addEventListener("click", switchToPolygon);

      // ====== COPY + ADD TOKEN ======
      document.getElementById("btnCopy")?.addEventListener("click", async ()=>{
        try{ await navigator.clipboard.writeText(TFPCOIN.address); alert("Contract copied!"); }
        catch(e){ alert("Copy failed. Please copy manually."); }
      });

      document.getElementById("btnAddMM")?.addEventListener("click", async ()=>{
        if(!window.ethereum) return alert("MetaMask not detected.");
        try{
          await window.ethereum.request({
            method: "wallet_watchAsset",
            params: {
              type: "ERC20",
              options: {
                address: TFPCOIN.address,
                symbol: TFPCOIN.symbol,
                decimals: TFPCOIN.decimals
              }
            }
          });
        } catch(e){
          alert("Could not add token. Make sure you're connected to MetaMask.");
        }
      });

      // ====== LIVE PRICE via DexScreener ======
      async function loadDexData(){
        const priceEl = document.getElementById("priceUsd");
        const mcEl = document.getElementById("mcUsd");
        const tfp70El = document.getElementById("tfpFor70");
        const noteEl = document.getElementById("priceNote");

        try{
          const url = "https://api.dexscreener.com/latest/dex/tokens/" + TFPCOIN.address;
          const res = await fetch(url, { cache: "no-store" });
          if(!res.ok) throw new Error("DexScreener not available");
          const data = await res.json();

          const pair = data?.pairs?.[0];
          const priceUsd = parseFloat(pair?.priceUsd || "NaN");
          const fdv = pair?.fdv;

          if(!isFinite(priceUsd)){
            if (priceEl) priceEl.textContent = "—";
            if (mcEl) mcEl.textContent = "—";
            if (tfp70El) tfp70El.textContent = "—";
            if (noteEl) noteEl.textContent = "Not indexed yet. Try again soon.";
            return;
          }

          if (priceEl) priceEl.textContent = "$" + priceUsd.toFixed(priceUsd < 0.01 ? 8 : 4);
          if (noteEl) noteEl.textContent = "Updated from DexScreener.";
          if (mcEl) mcEl.textContent = fdv ? ("$" + Number(fdv).toLocaleString()) : "—";
          if (tfp70El) tfp70El.textContent = Math.round(70 / priceUsd).toLocaleString();

        } catch(e){
          if (priceEl) priceEl.textContent = "—";
          if (mcEl) mcEl.textContent = "—";
          if (tfp70El) tfp70El.textContent = "—";
          if (noteEl) noteEl.textContent = "Price source unavailable yet.";
        }
      }

      checkNetworkPill();
      loadDexData();
      setInterval(loadDexData, 60000);

      if(window.ethereum){
        window.ethereum.on?.("chainChanged", ()=>checkNetworkPill());
      }

      // ====== SHOPIFY (render ONCE — fixes “double” issue) ======
      let shopifyMounted = false;

      function renderShopifyOnce() {
        if (shopifyMounted) return;

        const mountNode = document.getElementById("product-component-1769653146260");
        if (!mountNode) return;

        const scriptURL = "https://sdks.shopifycdn.com/buy-button/latest/buy-button-storefront.min.js";

        function mount() {
          const client = ShopifyBuy.buildClient({
            domain: "z4qefk-85.myshopify.com",
            storefrontAccessToken: "31f257118ca68b69b2444216cdeb80d7",
          });

          ShopifyBuy.UI.onReady(client).then(function (ui) {
            ui.createComponent("product", {
              id: "10360105107758",
              node: mountNode,
              moneyFormat: "%24%7B%7Bamount%7D%7D",
              options: { product: { buttonDestination: "checkout" } }
            });
            shopifyMounted = true;
          });
        }

        if (window.ShopifyBuy && window.ShopifyBuy.UI) mount();
        else {
          const s = document.createElement("script");
          s.async = true;
          s.src = scriptURL;
          s.onload = mount;
          document.head.appendChild(s);
        }
      }

      // expose for openMerch()
      window.renderShopifyOnce = renderShopifyOnce;
    });
  </script>
</body>
</html>
